.rn '' }`
''' $RCSfile$$Revision$$Date$
'''
''' $Log$
'''
.de Sh
.br
.if t .Sp
.ne 5
.PP
\fB\\$1\fR
.PP
..
.de Sp
.if t .sp .5v
.if n .sp
..
.de Ip
.br
.ie \\n(.$>=3 .ne \\$3
.el .ne 3
.IP "\\$1" \\$2
..
.de Vb
.ft CW
.nf
.ne \\$1
..
.de Ve
.ft R

.fi
..
'''
'''
'''     Set up \*(-- to give an unbreakable dash;
'''     string Tr holds user defined translation string.
'''     Bell System Logo is used as a dummy character.
'''
.tr \(*W-|\(bv\*(Tr
.ie n \{\
.ds -- \(*W-
.ds PI pi
.if (\n(.H=4u)&(1m=24u) .ds -- \(*W\h'-12u'\(*W\h'-12u'-\" diablo 10 pitch
.if (\n(.H=4u)&(1m=20u) .ds -- \(*W\h'-12u'\(*W\h'-8u'-\" diablo 12 pitch
.ds L" ""
.ds R" ""
'''   \*(M", \*(S", \*(N" and \*(T" are the equivalent of
'''   \*(L" and \*(R", except that they are used on ".xx" lines,
'''   such as .IP and .SH, which do another additional levels of
'''   double-quote interpretation
.ds M" """
.ds S" """
.ds N" """""
.ds T" """""
.ds L' '
.ds R' '
.ds M' '
.ds S' '
.ds N' '
.ds T' '
'br\}
.el\{\
.ds -- \(em\|
.tr \*(Tr
.ds L" ``
.ds R" ''
.ds M" ``
.ds S" ''
.ds N" ``
.ds T" ''
.ds L' `
.ds R' '
.ds M' `
.ds S' '
.ds N' `
.ds T' '
.ds PI \(*p
'br\}
.\"	If the F register is turned on, we'll generate
.\"	index entries out stderr for the following things:
.\"		TH	Title 
.\"		SH	Header
.\"		Sh	Subsection 
.\"		Ip	Item
.\"		X<>	Xref  (embedded
.\"	Of course, you have to process the output yourself
.\"	in some meaninful fashion.
.if \nF \{
.de IX
.tm Index:\\$1\t\\n%\t"\\$2"
..
.nr % 0
.rr F
.\}
.TH X509_check_host 3 "1.0.2g" "1/Mar/2016" "OpenSSL"
.UC
.if n .hy 0
.if n .na
.ds C+ C\v'-.1v'\h'-1p'\s-2+\h'-1p'+\s0\v'.1v'\h'-1p'
.de CQ          \" put $1 in typewriter font
.ft CW
'if n "\c
'if t \\&\\$1\c
'if n \\&\\$1\c
'if n \&"
\\&\\$2 \\$3 \\$4 \\$5 \\$6 \\$7
'.ft R
..
.\" @(#)ms.acc 1.5 88/02/08 SMI; from UCB 4.2
.	\" AM - accent mark definitions
.bd B 3
.	\" fudge factors for nroff and troff
.if n \{\
.	ds #H 0
.	ds #V .8m
.	ds #F .3m
.	ds #[ \f1
.	ds #] \fP
.\}
.if t \{\
.	ds #H ((1u-(\\\\n(.fu%2u))*.13m)
.	ds #V .6m
.	ds #F 0
.	ds #[ \&
.	ds #] \&
.\}
.	\" simple accents for nroff and troff
.if n \{\
.	ds ' \&
.	ds ` \&
.	ds ^ \&
.	ds , \&
.	ds ~ ~
.	ds ? ?
.	ds ! !
.	ds /
.	ds q
.\}
.if t \{\
.	ds ' \\k:\h'-(\\n(.wu*8/10-\*(#H)'\'\h"|\\n:u"
.	ds ` \\k:\h'-(\\n(.wu*8/10-\*(#H)'\`\h'|\\n:u'
.	ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'^\h'|\\n:u'
.	ds , \\k:\h'-(\\n(.wu*8/10)',\h'|\\n:u'
.	ds ~ \\k:\h'-(\\n(.wu-\*(#H-.1m)'~\h'|\\n:u'
.	ds ? \s-2c\h'-\w'c'u*7/10'\u\h'\*(#H'\zi\d\s+2\h'\w'c'u*8/10'
.	ds ! \s-2\(or\s+2\h'-\w'\(or'u'\v'-.8m'.\v'.8m'
.	ds / \\k:\h'-(\\n(.wu*8/10-\*(#H)'\z\(sl\h'|\\n:u'
.	ds q o\h'-\w'o'u*8/10'\s-4\v'.4m'\z\(*i\v'-.4m'\s+4\h'\w'o'u*8/10'
.\}
.	\" troff and (daisy-wheel) nroff accents
.ds : \\k:\h'-(\\n(.wu*8/10-\*(#H+.1m+\*(#F)'\v'-\*(#V'\z.\h'.2m+\*(#F'.\h'|\\n:u'\v'\*(#V'
.ds 8 \h'\*(#H'\(*b\h'-\*(#H'
.ds v \\k:\h'-(\\n(.wu*9/10-\*(#H)'\v'-\*(#V'\*(#[\s-4v\s0\v'\*(#V'\h'|\\n:u'\*(#]
.ds _ \\k:\h'-(\\n(.wu*9/10-\*(#H+(\*(#F*2/3))'\v'-.4m'\z\(hy\v'.4m'\h'|\\n:u'
.ds . \\k:\h'-(\\n(.wu*8/10)'\v'\*(#V*4/10'\z.\v'-\*(#V*4/10'\h'|\\n:u'
.ds 3 \*(#[\v'.2m'\s-2\&3\s0\v'-.2m'\*(#]
.ds o \\k:\h'-(\\n(.wu+\w'\(de'u-\*(#H)/2u'\v'-.3n'\*(#[\z\(de\v'.3n'\h'|\\n:u'\*(#]
.ds d- \h'\*(#H'\(pd\h'-\w'~'u'\v'-.25m'\f2\(hy\fP\v'.25m'\h'-\*(#H'
.ds D- D\\k:\h'-\w'D'u'\v'-.11m'\z\(hy\v'.11m'\h'|\\n:u'
.ds th \*(#[\v'.3m'\s+1I\s-1\v'-.3m'\h'-(\w'I'u*2/3)'\s-1o\s+1\*(#]
.ds Th \*(#[\s+2I\s-2\h'-\w'I'u*3/5'\v'-.3m'o\v'.3m'\*(#]
.ds ae a\h'-(\w'a'u*4/10)'e
.ds Ae A\h'-(\w'A'u*4/10)'E
.ds oe o\h'-(\w'o'u*4/10)'e
.ds Oe O\h'-(\w'O'u*4/10)'E
.	\" corrections for vroff
.if v .ds ~ \\k:\h'-(\\n(.wu*9/10-\*(#H)'\s-2\u~\d\s+2\h'|\\n:u'
.if v .ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'\v'-.4m'^\v'.4m'\h'|\\n:u'
.	\" for low resolution devices (crt and lpr)
.if \n(.H>23 .if \n(.V>19 \
\{\
.	ds : e
.	ds 8 ss
.	ds v \h'-1'\o'\(aa\(ga'
.	ds _ \h'-1'^
.	ds . \h'-1'.
.	ds 3 3
.	ds o a
.	ds d- d\h'-1'\(ga
.	ds D- D\h'-1'\(hy
.	ds th \o'bp'
.	ds Th \o'LP'
.	ds ae ae
.	ds Ae AE
.	ds oe oe
.	ds Oe OE
.\}
.rm #[ #] #H #V #F C
.SH "NAME"
X509_check_host, X509_check_email, X509_check_ip, X509_check_ip_asc \- X.509 certificate matching
.SH "SYNOPSIS"
.PP
.Vb 1
\& #include <openssl/x509.h>
.Ve
.Vb 7
\& int X509_check_host(X509 *, const char *name, size_t namelen,
\&                     unsigned int flags, char **peername);
\& int X509_check_email(X509 *, const char *address, size_t addresslen,
\&                      unsigned int flags);
\& int X509_check_ip(X509 *, const unsigned char *address, size_t addresslen,
\&                   unsigned int flags);
\& int X509_check_ip_asc(X509 *, const char *address, unsigned int flags);
.Ve
.SH "DESCRIPTION"
The certificate matching functions are used to check whether a
certificate matches a given host name, email address, or IP address.
The validity of the certificate and its trust level has to be checked by
other means.
.PP
\fIX509_check_host()\fR checks if the certificate Subject Alternative
Name (SAN) or Subject CommonName (CN) matches the specified host
name, which must be encoded in the preferred name syntax described
in section 3.5 of RFC 1034.  By default, wildcards are supported
and they match  only in the left-most label; but they may match
part of that label with an explicit prefix or suffix.  For example,
by default, the host \fBname\fR \*(L"www.example.com\*(R" would match a
certificate with a SAN or CN value of \*(L"*.example.com\*(R", \*(L"w*.example.com\*(R"
or \*(L"*w.example.com\*(R".
.PP
Per section 6.4.2 of RFC 6125, \fBname\fR values representing international
domain names must be given in A\-label form.  The \fBnamelen\fR argument
must be the number of characters in the name string or zero in which
case the length is calculated with \fIstrlen\fR\|(\fBname\fR).  When \fBname\fR starts
with a dot (e.g \*(L".example.com"), it will be matched by a certificate
valid for any sub-domain of \fBname\fR, (see also
\fBX509_CHECK_FLAG_SINGLE_LABEL_SUBDOMAINS\fR below).
.PP
When the certificate is matched, and \fBpeername\fR is not NULL, a
pointer to a copy of the matching SAN or CN from the peer certificate
is stored at the address passed in \fBpeername\fR.  The application
is responsible for freeing the peername via \fIOPENSSL_free()\fR when it
is no longer needed.
.PP
\fIX509_check_email()\fR checks if the certificate matches the specified
email \fBaddress\fR.  Only the mailbox syntax of RFC 822 is supported,
comments are not allowed, and no attempt is made to normalize quoted
characters.  The \fBaddresslen\fR argument must be the number of
characters in the address string or zero in which case the length
is calculated with \fIstrlen\fR\|(\fBaddress\fR).
.PP
\fIX509_check_ip()\fR checks if the certificate matches a specified IPv4 or
IPv6 address.  The \fBaddress\fR array is in binary format, in network
byte order.  The length is either 4 (IPv4) or 16 (IPv6).  Only
explicitly marked addresses in the certificates are considered; IP
addresses stored in DNS names and Common Names are ignored.
.PP
\fIX509_check_ip_asc()\fR is similar, except that the NUL\-terminated
string \fBaddress\fR is first converted to the internal representation.
.PP
The \fBflags\fR argument is usually 0.  It can be the bitwise OR of the
flags:
.Ip "\fBX509_CHECK_FLAG_ALWAYS_CHECK_SUBJECT\fR," 4
.Ip "\fBX509_CHECK_FLAG_NO_WILDCARDS\fR," 4
.Ip "\fBX509_CHECK_FLAG_NO_PARTIAL_WILDCARDS\fR," 4
.Ip "\fBX509_CHECK_FLAG_MULTI_LABEL_WILDCARDS\fR." 4
.Ip "\fBX509_CHECK_FLAG_SINGLE_LABEL_SUBDOMAINS\fR." 4
.PP
The \fBX509_CHECK_FLAG_ALWAYS_CHECK_SUBJECT\fR flag causes the function
to consider the subject \s-1DN\s0 even if the certificate contains at least
one subject alternative name of the right type (\s-1DNS\s0 name or email
address as appropriate); the default is to ignore the subject \s-1DN\s0
when at least one corresponding subject alternative names is present.
.PP
If set, \fBX509_CHECK_FLAG_NO_WILDCARDS\fR disables wildcard
expansion; this only applies to \fBX509_check_host\fR.
.PP
If set, \fBX509_CHECK_FLAG_NO_PARTIAL_WILDCARDS\fR suppresses support
for \*(L"*\*(R" as wildcard pattern in labels that have a prefix or suffix,
such as: \*(L"www*\*(R" or \*(L"*www\*(R"; this only aplies to \fBX509_check_host\fR.
.PP
If set, \fBX509_CHECK_FLAG_MULTI_LABEL_WILDCARDS\fR allows a \*(L"*\*(R" that
constitutes the complete label of a \s-1DNS\s0 name (e.g. \*(L"*.example.com")
to match more than one label in \fBname\fR; this flag only applies
to \fBX509_check_host\fR.
.PP
If set, \fBX509_CHECK_FLAG_SINGLE_LABEL_SUBDOMAINS\fR restricts \fBname\fR
values which start with \*(L".\*(R", that would otherwise match any sub-domain
in the peer certificate, to only match direct child sub-domains.
Thus, for instance, with this flag set a \fBname\fR of \*(L".example.com\*(R"
would match a peer certificate with a \s-1DNS\s0 name of \*(L"www.example.com\*(R",
but would not match a peer certificate with a \s-1DNS\s0 name of
\*(L"www.sub.example.com\*(R"; this flag only applies to \fBX509_check_host\fR.
.SH "RETURN VALUES"
The functions return 1 for a successful match, 0 for a failed match
and \-1 for an internal error: typically a memory allocation failure
or an ASN.1 decoding error.
.PP
All functions can also return \-2 if the input is malformed. For example,
\fIX509_check_host()\fR returns \-2 if the provided \fBname\fR contains embedded
NULs.
.SH "NOTES"
Applications are encouraged to use \fIX509_VERIFY_PARAM_set1_host()\fR
rather than explicitly calling the \fIX509_check_host(3)\fR manpage. Host name
checks are out of scope with the DANE\-\fIEE\fR\|(3) certificate usage,
and the internal checks will be suppressed as appropriate when
DANE support is added to OpenSSL.
.SH "SEE ALSO"
SSL_get_verify_result(3),
X509_VERIFY_PARAM_set1_host(3),
X509_VERIFY_PARAM_add1_host(3),
X509_VERIFY_PARAM_set1_email(3),
X509_VERIFY_PARAM_set1_ip(3),
X509_VERIFY_PARAM_set1_ipasc(3)
.SH "HISTORY"
These functions were added in OpenSSL 1.0.2.

.rn }` ''
.IX Title "X509_check_host 3"
.IX Name "X509_check_host, X509_check_email, X509_check_ip, X509_check_ip_asc - X.509 certificate matching"

.IX Header "NAME"

.IX Header "SYNOPSIS"

.IX Header "DESCRIPTION"

.IX Item "\fBX509_CHECK_FLAG_ALWAYS_CHECK_SUBJECT\fR,"

.IX Item "\fBX509_CHECK_FLAG_NO_WILDCARDS\fR,"

.IX Item "\fBX509_CHECK_FLAG_NO_PARTIAL_WILDCARDS\fR,"

.IX Item "\fBX509_CHECK_FLAG_MULTI_LABEL_WILDCARDS\fR."

.IX Item "\fBX509_CHECK_FLAG_SINGLE_LABEL_SUBDOMAINS\fR."

.IX Header "RETURN VALUES"

.IX Header "NOTES"

.IX Header "SEE ALSO"

.IX Header "HISTORY"

